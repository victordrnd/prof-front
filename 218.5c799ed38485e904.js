"use strict";(self.webpackChunkprof_front=self.webpackChunkprof_front||[]).push([[218],{8574:(k,M,r)=>{r.d(M,{P:()=>e});var v=r(655),n=r(5e3),S=r(325),u=r(263);let e=(()=>{class z{constructor(l,N){this.router=l,this.userService=N}canActivate(){return(0,v.mG)(this,void 0,void 0,function*(){return yield this.userService.populate(),!!this.userService.getToken()||(this.router.navigate(["/login"]),!1)})}}return z.\u0275fac=function(l){return new(l||z)(n.LFG(S.F0),n.LFG(u.e))},z.\u0275prov=n.Yz7({token:z,factory:z.\u0275fac,providedIn:"root"}),z})()},3175:(k,M,r)=>{r.d(M,{a:()=>N});var v=r(655),n=r(1069),S=r(591),u=r(2340),e=r(5e3),z=r(520),O=r(8393),l=r(263);let N=(()=>{class _{constructor(d,y,b){this.http=d,this.socket=y,this.userService=b,this.isRegistred=!1,this.currentRoomId=null,this.rooms=new S.X([]),this.unreadMessageCount=new S.X(0),this.audioService=new Audio,this.subscriptions=[],y.on("connect",function(){y.emit("register",{userId:b.currentUserValue.id})}),y.on("disconnect",()=>this.isRegistred=!1)}connect(d=!1){return(0,v.mG)(this,void 0,void 0,function*(){console.log(d),(!this.isRegistred||d)&&(this.isRegistred=!0,this.clearSubscriptions(),this.clearUnReadMessage(),this.subscribeToNewMessages())})}clearUnReadMessage(){this.unreadMessageCount.next(0)}clearUnReadMessageForRoom(d){const y=this.rooms.value,b=y.find(E=>E.id==d);b&&(b.new_message=!1),this.rooms.next(y)}setNewMessage(d){const y=this.rooms.value,b=y.find(h=>h.id==d.roomId);d.userId!=this.userService.currentUserValue.id&&d.roomId!=this.currentRoomId&&(b.new_message=!0),b.updated_at=(new Date).toISOString(),b.last_message=d;const E=y.sort((h,x)=>new Date(x.updated_at).getTime()-new Date(h.updated_at).getTime());this.rooms.next(E)}getMyRooms(){return(0,v.mG)(this,void 0,void 0,function*(){let d=yield this.http.get(`${u.N.chatServer}/rooms/my`,{context:(0,n.DN)({key:"rooms"})}).toPromise();this.rooms.next(d)})}getRoomMessages(d){return this.http.get(`${u.N.chatServer}/rooms/${d}/messages`)}createRoom(d){return d.users=d.users.map(y=>y.id),this.http.post(`${u.N.chatServer}/rooms`,d)}getRoom(d){return this.http.get(`${u.N.chatServer}/rooms/${d}`)}sendMessage(d,y=!1){y?this.http.post(`${u.N.chatServer}/messages`,d).toPromise():this.socket.emit("new_message",d)}onNewMessage(){return this.socket.fromEvent("new_message")}clearSubscriptions(){this.subscriptions.map(d=>d.unsubscribe())}subscribeToNewMessages(){const d=this.onNewMessage().subscribe(y=>{this.setNewMessage(y),y.userId!=this.userService.currentUserValue.id&&(this.audioService.src="../../../assets/mp3/message.mp3",this.audioService.load(),this.audioService.play(),y.roomId!=this.currentRoomId&&this.unreadMessageCount.next(this.unreadMessageCount.value+1))});this.subscriptions.push(d)}emitNewRoomCreate(d){this.socket.emit("new_room",d)}}return _.\u0275fac=function(d){return new(d||_)(e.LFG(z.eN),e.LFG(O.sk),e.LFG(l.e))},_.\u0275prov=e.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),_})()},2171:(k,M,r)=>{r.d(M,{J:()=>e});var v=r(520),n=r(2340),S=r(1069),u=r(5e3);let e=(()=>{class z{constructor(l,N){this.http=l,this.cache=N}getMyLessons(l){const N=new v.LE({fromObject:l});return this.http.get(`${n.N.apiUrl}/lessons`,{params:N,context:(0,S.DN)({key:"lessons"})})}getHistory(l){const N=new v.LE({fromObject:l});return this.http.get(`${n.N.apiUrl}/lessons/history`,{params:N,context:(0,S.DN)()})}find(l){return this.http.get(`${n.N.apiUrl}/lessons/${l}`)}store(l){return this.cache.delete("lessons"),this.cache.delete("calendar"),this.http.post(`${n.N.apiUrl}/lessons`,Object.assign({},l))}createCollabLesson(l){return this.http.post(`${n.N.apiUrl}/teacher/lesson/create`,l)}joinCollaborationLesson(l){return this.http.post(`${n.N.apiUrl}/lessons/join/${l}`,{})}cancel(l){return this.http.delete(`${n.N.apiUrl}/lessons/${l}`)}confirm(l){return this.cache.delete("lessons"),this.cache.delete("calendar"),this.http.put(`${n.N.apiUrl}/teacher/lesson/confirm/${l}`,{})}update(l){return this.http.put(`${n.N.apiUrl}/lessons/${l.id}`,l)}}return z.\u0275fac=function(l){return new(l||z)(u.LFG(v.eN),u.LFG(S.Hg))},z.\u0275prov=u.Yz7({token:z,factory:z.\u0275fac,providedIn:"root"}),z})()},7218:(k,M,r)=>{r.r(M),r.d(M,{ClassroomModule:()=>Ge});var v=r(9808),n=r(325),S=r(8574),u=r(655),e=r(5e3),z=r(263),O=r(591),l=r(8929),N=r(8393);let P=(()=>{class o{constructor(t){this.socket=t,this.peerConnectionSubject=new O.X(this.openRTCConnection()),this.currentRoomId=null,this.subscriptions=[],this.onNewParticipant=new l.xQ,this.onNewMessage=new l.xQ,this.onRemoteCameraChange=new l.xQ}joinRoom(t,i=!0,s=!0){return(0,u.mG)(this,void 0,void 0,function*(){this.peerConnection.onicecandidate=T=>{T.candidate&&this.socket.emit("classroom.new-ice-candidate",{candidat:T.candidate,room_id:t.room_id})},this.peerConnection.onnegotiationneeded=T=>{this.peerConnection.createOffer().then(A=>this.peerConnection.setLocalDescription(A)).then(()=>{this.socket.emit("classroom.negociating",{room_id:t.room_id,sessionDescription:this.peerConnection.localDescription})}).catch(A=>console.log(A))};const m=this.socket.fromEvent("classroom.negociating").subscribe(T=>{this.sendAnswer(T.sessionDescription)}),R=this.socket.fromEvent("classroom.answer").subscribe(T=>(0,u.mG)(this,void 0,void 0,function*(){this.peerConnection.remoteDescription||(yield this.peerConnection.setRemoteDescription(new RTCSessionDescription(T.answer)),this.onNewParticipant.next(T))})),F=this.socket.fromEvent("classroom.need_answer").subscribe(T=>{this.sendAnswer(T.sessionDescription,i,s)}),B=this.socket.fromEvent("classroom.new-ice-candidate").subscribe(T=>(0,u.mG)(this,void 0,void 0,function*(){const A=new RTCIceCandidate(T);try{yield this.peerConnection.addIceCandidate(A)}catch(dt){}})),Q=this.socket.fromEvent("classroom.new_message").subscribe(T=>{this.onNewMessage.next(T)}),J=this.socket.fromEvent("classroom.camera_toggle").subscribe(T=>{console.log("camera toogled",T),this.onRemoteCameraChange.next(T)}),G=this.socket.fromEvent("classroom.disconnect").subscribe(T=>{this.clearSubscription()});this.socket.emit("classroom.join",t),this.subscriptions.push(m,R,F,B,G,Q,J)})}sendAnswer(t,i=!0,s=!0){return(0,u.mG)(this,void 0,void 0,function*(){if(this.stream||(yield this.getMediaStream(i,s),this.addTracksToPeerConnection(this.stream)),!this.peerConnection.remoteDescription){yield this.peerConnection.setRemoteDescription(new RTCSessionDescription(t));const m=yield this.peerConnection.createAnswer();this.peerConnection.setLocalDescription(m),this.socket.emit("classroom.answer",{room_id:this.currentRoomId,answer:m}),this.onNewParticipant.next(m)}})}createOffer(t=!0,i=!0){return(0,u.mG)(this,void 0,void 0,function*(){yield this.getMediaStream(t,i),this.addTracksToPeerConnection(this.stream);let s=yield this.peerConnection.createOffer();return this.peerConnection.setLocalDescription(s),s})}startAudio(){this.stream&&this.stream.getAudioTracks().forEach(t=>t.enabled=!0)}stopAudio(){this.stream.getAudioTracks().forEach(t=>t.enabled=!1)}startVideo(){this.stream.getVideoTracks().forEach(t=>t.enabled=!0),this.socket.emit("classroom.camera_toggle",{room_id:this.currentRoomId,active:!0})}stopVideo(){this.stream.getVideoTracks().forEach(t=>t.enabled=!1),this.socket.emit("classroom.camera_toggle",{room_id:this.currentRoomId,active:!1})}sendMessage(t){this.socket.emit("classroom.new_message",t)}addTracksToPeerConnection(t){t&&t.getTracks().forEach(i=>{this.peerConnection.addTrack(i,t)})}getMediaStream(t=!0,i=!0){return(0,u.mG)(this,void 0,void 0,function*(){let s={audio:i,video:t};try{navigator.mediaDevices&&(this.stream=yield navigator.mediaDevices.getUserMedia({audio:i,video:!!t&&{width:{ideal:4096},height:{ideal:2160}}}))}catch(m){console.log(m),s={audio:!1,video:t},this.stream=yield navigator.mediaDevices.getUserMedia(s)}return s})}startScreenShare(){return(0,u.mG)(this,void 0,void 0,function*(){const t=yield navigator.mediaDevices.getDisplayMedia({audio:!0,video:!0}),i=t.getVideoTracks()[0];if(this.videoTrack){this.videoTrack.replaceTrack(i);try{this.videoTrack=this.peerConnection.addTrack(i,this.stream)}catch(s){this.stream.getVideoTracks().forEach(m=>m.enabled=!0)}}else this.addTracksToPeerConnection(t)})}stopScreenShare(){return(0,u.mG)(this,void 0,void 0,function*(){this.stream&&this.stream.getVideoTracks().forEach(t=>{t.enabled=!1})})}openRTCConnection(){return new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]})}sendDisconnect(){this.socket.emit("classroom.disconnect",{})}clearSubscription(){this.stream&&this.stream.getTracks().map(t=>t.stop()),this.peerConnection.ontrack=null,this.peerConnection.onicecandidate=null,this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicegatheringstatechange=null,this.peerConnection.onnegotiationneeded=null,this.peerConnection.close(),this.stream=null,this.peerConnectionSubject.next(this.openRTCConnection()),this.subscriptions.map(t=>t.unsubscribe()),console.log("La connexion a \xe9t\xe9 interrompu, refreshing"),window.location.reload()}get peerConnection(){return this.peerConnectionSubject.getValue()}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(N.sk))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var U=r(2171),_=r(8669),I=r(6699);let d=(()=>{class o{constructor(){this.isMic=!0,this.isCamera=!0,this.onCameraChange=new e.vpe,this.onMicrophoneChange=new e.vpe,this.screenSharing=!1,this.screenSharingChange=new e.vpe,this.onLeave=new e.vpe,this.onOpenChat=new e.vpe,this.unReadMessage=0,this.startDate=null,this.timeElapsed=0}ngOnInit(){setInterval(()=>{this.timeElapsed++,this.startDate=new Date(1e3*this.timeElapsed).toISOString().substr(14,5)},1e3)}microphoneChange(){this.isMic=!this.isMic,this.onMicrophoneChange.emit(this.isMic)}cameraChange(){this.isCamera=!this.isCamera,this.onCameraChange.emit(this.isCamera)}onScreenSharingChange(){this.screenSharing=!this.screenSharing,this.screenSharingChange.emit(this.screenSharing)}onOpenChatFn(){this.onOpenChat.emit()}leave(){this.onLeave.emit()}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-call-controls"]],inputs:{screenSharing:"screenSharing",unReadMessage:"unReadMessage"},outputs:{onCameraChange:"onCameraChange",onMicrophoneChange:"onMicrophoneChange",screenSharingChange:"screenSharingChange",onLeave:"onLeave",onOpenChat:"onOpenChat"},decls:9,vars:11,consts:[[1,"call-controls"],[1,"text-center","text-grey"],["size","small"],[1,"text-primary","pointer",3,"icon","click"],["badgePosition","top left","badgeStatus","primary","icon","message-square-outline",3,"badgeDot","click"],["icon","phone-off-outline",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"p",1),e._uU(2),e.qZA(),e.TgZ(3,"nb-actions",2)(4,"nb-action",3),e.NdJ("click",function(){return i.microphoneChange()}),e.qZA(),e.TgZ(5,"nb-action",3),e.NdJ("click",function(){return i.cameraChange()}),e.qZA(),e.TgZ(6,"nb-action",3),e.NdJ("click",function(){return i.onScreenSharingChange()}),e.qZA(),e.TgZ(7,"nb-action",4),e.NdJ("click",function(){return i.onOpenChatFn()}),e.qZA(),e.TgZ(8,"nb-action",5),e.NdJ("click",function(){return i.leave()}),e.qZA()()()),2&t&&(e.xp6(2),e.Oqu(i.startDate),e.xp6(2),e.ekj("active",i.isMic),e.Q6J("icon",i.isMic?"mic-outline":"mic-off-outline"),e.xp6(1),e.ekj("active",i.isCamera),e.Q6J("icon",i.isCamera?"video-outline":"video-off-outline"),e.xp6(1),e.ekj("active",i.screenSharing),e.Q6J("icon","monitor-outline"),e.xp6(1),e.Q6J("badgeDot",i.unReadMessage>0))},directives:[_.lYD,_.Bk3],styles:["[_nghost-%COMP%]  .ant-card-body{display:none}[_nghost-%COMP%]  ul li:last-child{background-color:red;color:#fff}[_nghost-%COMP%]  .ant-card-actions>li{float:left;padding:12px 0!important;margin:0!important}[_nghost-%COMP%]  .text-grey{color:#8f9bb3}[_nghost-%COMP%]  nb-actions{background:white;padding:12px;border-radius:7px}[_nghost-%COMP%]  .active nb-icon{color:#45aca0}.call-controls[_ngcontent-%COMP%]{position:fixed;bottom:50px;left:50%;transform:translate(-50%)}"]}),o})();var y=r(9470),b=r(3713),E=r(1159),h=r(1314),x=r(7429),p=r(7625),c=r(9439),g=r(1721),C=r(5664),f=r(226),D=r(4832),w=r(969),Z=r(3087);const L=["drawerTemplate"];function $(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div",11),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).maskClick()}),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("ngStyle",t.nzMaskStyle)}}function K(o,a){if(1&o&&(e.ynx(0),e._UZ(1,"i",19),e.BQk()),2&o){const t=a.$implicit;e.xp6(1),e.Q6J("nzType",t)}}function X(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"button",17),e.NdJ("click",function(){return e.CHM(t),e.oxw(3).closeClick()}),e.YNc(1,K,2,1,"ng-container",18),e.qZA()}if(2&o){const t=e.oxw(3);e.xp6(1),e.Q6J("nzStringTemplateOutlet",t.nzCloseIcon)}}function q(o,a){if(1&o&&(e.ynx(0),e._UZ(1,"div",21),e.BQk()),2&o){const t=e.oxw(4);e.xp6(1),e.Q6J("innerHTML",t.nzTitle,e.oJD)}}function ee(o,a){if(1&o&&(e.TgZ(0,"div",20),e.YNc(1,q,2,1,"ng-container",18),e.qZA()),2&o){const t=e.oxw(3);e.xp6(1),e.Q6J("nzStringTemplateOutlet",t.nzTitle)}}function te(o,a){if(1&o&&(e.ynx(0),e._UZ(1,"div",21),e.BQk()),2&o){const t=e.oxw(4);e.xp6(1),e.Q6J("innerHTML",t.nzExtra,e.oJD)}}function ne(o,a){if(1&o&&(e.TgZ(0,"div",22),e.YNc(1,te,2,1,"ng-container",18),e.qZA()),2&o){const t=e.oxw(3);e.xp6(1),e.Q6J("nzStringTemplateOutlet",t.nzExtra)}}function oe(o,a){if(1&o&&(e.TgZ(0,"div",12)(1,"div",13),e.YNc(2,X,2,1,"button",14),e.YNc(3,ee,2,1,"div",15),e.qZA(),e.YNc(4,ne,2,1,"div",16),e.qZA()),2&o){const t=e.oxw(2);e.ekj("ant-drawer-header-close-only",!t.nzTitle),e.xp6(2),e.Q6J("ngIf",t.nzClosable),e.xp6(1),e.Q6J("ngIf",t.nzTitle),e.xp6(1),e.Q6J("ngIf",t.nzExtra)}}function ie(o,a){}function ae(o,a){1&o&&e.GkF(0)}function re(o,a){if(1&o&&(e.ynx(0),e.YNc(1,ae,1,0,"ng-container",24),e.BQk()),2&o){const t=e.oxw(3);e.xp6(1),e.Q6J("ngTemplateOutlet",t.nzContent)("ngTemplateOutletContext",t.templateContext)}}function se(o,a){if(1&o&&(e.ynx(0),e.YNc(1,re,2,2,"ng-container",23),e.BQk()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.isTemplateRef(t.nzContent))}}function ce(o,a){}function le(o,a){if(1&o&&(e.ynx(0),e.YNc(1,ce,0,0,"ng-template",25),e.BQk()),2&o){const t=e.oxw(3);e.xp6(1),e.Q6J("ngTemplateOutlet",t.contentFromContentChild)}}function de(o,a){if(1&o&&e.YNc(0,le,2,1,"ng-container",23),2&o){const t=e.oxw(2);e.Q6J("ngIf",t.contentFromContentChild&&(t.isOpen||t.inAnimation))}}function pe(o,a){if(1&o&&(e.ynx(0),e._UZ(1,"div",21),e.BQk()),2&o){const t=e.oxw(3);e.xp6(1),e.Q6J("innerHTML",t.nzFooter,e.oJD)}}function he(o,a){if(1&o&&(e.TgZ(0,"div",26),e.YNc(1,pe,2,1,"ng-container",18),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("nzStringTemplateOutlet",t.nzFooter)}}function ue(o,a){if(1&o&&(e.TgZ(0,"div",1),e.YNc(1,$,1,1,"div",2),e.TgZ(2,"div")(3,"div",3)(4,"div",4),e.YNc(5,oe,5,5,"div",5),e.TgZ(6,"div",6),e.YNc(7,ie,0,0,"ng-template",7),e.YNc(8,se,2,1,"ng-container",8),e.YNc(9,de,1,1,"ng-template",null,9,e.W1O),e.qZA(),e.YNc(11,he,2,1,"div",10),e.qZA()()()()),2&o){const t=e.MAs(10),i=e.oxw();e.Udp("transform",i.offsetTransform)("transition",i.placementChanging?"none":null)("z-index",i.nzZIndex),e.ekj("ant-drawer-rtl","rtl"===i.dir)("ant-drawer-open",i.isOpen)("no-mask",!i.nzMask)("ant-drawer-top","top"===i.nzPlacement)("ant-drawer-bottom","bottom"===i.nzPlacement)("ant-drawer-right","right"===i.nzPlacement)("ant-drawer-left","left"===i.nzPlacement),e.Q6J("nzNoAnimation",i.nzNoAnimation),e.xp6(1),e.Q6J("ngIf",i.nzMask),e.xp6(1),e.Gre("ant-drawer-content-wrapper ",i.nzWrapClassName,""),e.Udp("width",i.width)("height",i.height)("transform",i.transform)("transition",i.placementChanging?"none":null),e.xp6(2),e.Udp("height",i.isLeftOrRight?"100%":null),e.xp6(1),e.Q6J("ngIf",i.nzTitle||i.nzClosable),e.xp6(1),e.Q6J("ngStyle",i.nzBodyStyle),e.xp6(2),e.Q6J("ngIf",i.nzContent)("ngIfElse",t),e.xp6(3),e.Q6J("ngIf",i.nzFooter)}}let Y=(()=>{class o{constructor(t){this.templateRef=t}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.Rgc))},o.\u0275dir=e.lG2({type:o,selectors:[["","nzDrawerContent",""]],exportAs:["nzDrawerContent"]}),o})();class W{}let V=(()=>{class o extends W{constructor(t,i,s,m,R,F,B,Q,J,G,T){super(),this.cdr=t,this.document=i,this.nzConfigService=s,this.renderer=m,this.overlay=R,this.injector=F,this.changeDetectorRef=B,this.focusTrapFactory=Q,this.viewContainerRef=J,this.overlayKeyboardDispatcher=G,this.directionality=T,this._nzModuleName="drawer",this.nzCloseIcon="close",this.nzClosable=!0,this.nzMaskClosable=!0,this.nzMask=!0,this.nzCloseOnNavigation=!0,this.nzNoAnimation=!1,this.nzKeyboard=!0,this.nzPlacement="right",this.nzSize="default",this.nzMaskStyle={},this.nzBodyStyle={},this.nzZIndex=1e3,this.nzOffsetX=0,this.nzOffsetY=0,this.componentInstance=null,this.nzOnViewInit=new e.vpe,this.nzOnClose=new e.vpe,this.nzVisibleChange=new e.vpe,this.destroy$=new l.xQ,this.placementChanging=!1,this.placementChangeTimeoutId=-1,this.isOpen=!1,this.inAnimation=!1,this.templateContext={$implicit:void 0,drawerRef:this},this.nzAfterOpen=new l.xQ,this.nzAfterClose=new l.xQ,this.nzDirection=void 0,this.dir="ltr"}set nzVisible(t){this.isOpen=t}get nzVisible(){return this.isOpen}get offsetTransform(){if(!this.isOpen||this.nzOffsetX+this.nzOffsetY===0)return null;switch(this.nzPlacement){case"left":return`translateX(${this.nzOffsetX}px)`;case"right":return`translateX(-${this.nzOffsetX}px)`;case"top":return`translateY(${this.nzOffsetY}px)`;case"bottom":return`translateY(-${this.nzOffsetY}px)`}}get transform(){if(this.isOpen)return null;switch(this.nzPlacement){case"left":return"translateX(-100%)";case"right":return"translateX(100%)";case"top":return"translateY(-100%)";case"bottom":return"translateY(100%)"}}get width(){if(this.isLeftOrRight){const t="large"===this.nzSize?736:378;return(0,g.WX)(void 0===this.nzWidth?t:this.nzWidth)}return null}get height(){if(!this.isLeftOrRight){const t="large"===this.nzSize?736:378;return(0,g.WX)(void 0===this.nzHeight?t:this.nzHeight)}return null}get isLeftOrRight(){return"left"===this.nzPlacement||"right"===this.nzPlacement}get afterOpen(){return this.nzAfterOpen.asObservable()}get afterClose(){return this.nzAfterClose.asObservable()}isTemplateRef(t){return t instanceof e.Rgc}ngOnInit(){var t;null===(t=this.directionality.change)||void 0===t||t.pipe((0,p.R)(this.destroy$)).subscribe(i=>{this.dir=i,this.cdr.detectChanges()}),this.dir=this.nzDirection||this.directionality.value,this.attachOverlay(),this.updateOverlayStyle(),this.updateBodyOverflow(),this.templateContext={$implicit:this.nzContentParams,drawerRef:this},this.changeDetectorRef.detectChanges()}ngAfterViewInit(){this.attachBodyContent(),this.nzOnViewInit.observers.length&&setTimeout(()=>{this.nzOnViewInit.emit()})}ngOnChanges(t){const{nzPlacement:i,nzVisible:s}=t;s&&(t.nzVisible.currentValue?this.open():this.close()),i&&!i.isFirstChange()&&this.triggerPlacementChangeCycleOnce()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),clearTimeout(this.placementChangeTimeoutId),this.disposeOverlay()}getAnimationDuration(){return this.nzNoAnimation?0:300}triggerPlacementChangeCycleOnce(){this.nzNoAnimation||(this.placementChanging=!0,this.changeDetectorRef.markForCheck(),clearTimeout(this.placementChangeTimeoutId),this.placementChangeTimeoutId=setTimeout(()=>{this.placementChanging=!1,this.changeDetectorRef.markForCheck()},this.getAnimationDuration()))}close(t){this.isOpen=!1,this.inAnimation=!0,this.nzVisibleChange.emit(!1),this.updateOverlayStyle(),this.overlayKeyboardDispatcher.remove(this.overlayRef),this.changeDetectorRef.detectChanges(),setTimeout(()=>{this.updateBodyOverflow(),this.restoreFocus(),this.inAnimation=!1,this.nzAfterClose.next(t),this.nzAfterClose.complete(),this.componentInstance=null},this.getAnimationDuration())}open(){this.attachOverlay(),this.isOpen=!0,this.inAnimation=!0,this.nzVisibleChange.emit(!0),this.overlayKeyboardDispatcher.add(this.overlayRef),this.updateOverlayStyle(),this.updateBodyOverflow(),this.savePreviouslyFocusedElement(),this.trapFocus(),this.changeDetectorRef.detectChanges(),setTimeout(()=>{this.inAnimation=!1,this.changeDetectorRef.detectChanges(),this.nzAfterOpen.next()},this.getAnimationDuration())}getContentComponent(){return this.componentInstance}closeClick(){this.nzOnClose.emit()}maskClick(){this.nzMaskClosable&&this.nzMask&&this.nzOnClose.emit()}attachBodyContent(){if(this.bodyPortalOutlet.dispose(),this.nzContent instanceof e.DyG){const t=e.zs3.create({parent:this.injector,providers:[{provide:W,useValue:this}]}),i=new x.C5(this.nzContent,null,t),s=this.bodyPortalOutlet.attachComponentPortal(i);this.componentInstance=s.instance,Object.assign(s.instance,this.nzContentParams),s.changeDetectorRef.detectChanges()}}attachOverlay(){this.overlayRef||(this.portal=new x.UE(this.drawerTemplate,this.viewContainerRef),this.overlayRef=this.overlay.create(this.getOverlayConfig())),this.overlayRef&&!this.overlayRef.hasAttached()&&(this.overlayRef.attach(this.portal),this.overlayRef.keydownEvents().pipe((0,p.R)(this.destroy$)).subscribe(t=>{t.keyCode===E.hY&&this.isOpen&&this.nzKeyboard&&this.nzOnClose.emit()}),this.overlayRef.detachments().pipe((0,p.R)(this.destroy$)).subscribe(()=>{this.disposeOverlay()}))}disposeOverlay(){var t;null===(t=this.overlayRef)||void 0===t||t.dispose(),this.overlayRef=null}getOverlayConfig(){return new h.X_({disposeOnNavigation:this.nzCloseOnNavigation,positionStrategy:this.overlay.position().global(),scrollStrategy:this.overlay.scrollStrategies.block()})}updateOverlayStyle(){this.overlayRef&&this.overlayRef.overlayElement&&this.renderer.setStyle(this.overlayRef.overlayElement,"pointer-events",this.isOpen?"auto":"none")}updateBodyOverflow(){this.overlayRef&&(this.isOpen?this.overlayRef.getConfig().scrollStrategy.enable():this.overlayRef.getConfig().scrollStrategy.disable())}savePreviouslyFocusedElement(){this.document&&!this.previouslyFocusedElement&&(this.previouslyFocusedElement=this.document.activeElement,this.previouslyFocusedElement&&"function"==typeof this.previouslyFocusedElement.blur&&this.previouslyFocusedElement.blur())}trapFocus(){!this.focusTrap&&this.overlayRef&&this.overlayRef.overlayElement&&(this.focusTrap=this.focusTrapFactory.create(this.overlayRef.overlayElement),this.focusTrap.focusInitialElement())}restoreFocus(){this.previouslyFocusedElement&&"function"==typeof this.previouslyFocusedElement.focus&&this.previouslyFocusedElement.focus(),this.focusTrap&&this.focusTrap.destroy()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(v.K0,8),e.Y36(c.jY),e.Y36(e.Qsj),e.Y36(h.aV),e.Y36(e.zs3),e.Y36(e.sBO),e.Y36(C.qV),e.Y36(e.s_b),e.Y36(h.Vs),e.Y36(f.Is,8))},o.\u0275cmp=e.Xpm({type:o,selectors:[["nz-drawer"]],contentQueries:function(t,i,s){if(1&t&&e.Suo(s,Y,7,e.Rgc),2&t){let m;e.iGM(m=e.CRH())&&(i.contentFromContentChild=m.first)}},viewQuery:function(t,i){if(1&t&&(e.Gf(L,7),e.Gf(x.Pl,5)),2&t){let s;e.iGM(s=e.CRH())&&(i.drawerTemplate=s.first),e.iGM(s=e.CRH())&&(i.bodyPortalOutlet=s.first)}},inputs:{nzContent:"nzContent",nzCloseIcon:"nzCloseIcon",nzClosable:"nzClosable",nzMaskClosable:"nzMaskClosable",nzMask:"nzMask",nzCloseOnNavigation:"nzCloseOnNavigation",nzNoAnimation:"nzNoAnimation",nzKeyboard:"nzKeyboard",nzTitle:"nzTitle",nzExtra:"nzExtra",nzFooter:"nzFooter",nzPlacement:"nzPlacement",nzSize:"nzSize",nzMaskStyle:"nzMaskStyle",nzBodyStyle:"nzBodyStyle",nzWrapClassName:"nzWrapClassName",nzWidth:"nzWidth",nzHeight:"nzHeight",nzZIndex:"nzZIndex",nzOffsetX:"nzOffsetX",nzOffsetY:"nzOffsetY",nzVisible:"nzVisible"},outputs:{nzOnViewInit:"nzOnViewInit",nzOnClose:"nzOnClose",nzVisibleChange:"nzVisibleChange"},exportAs:["nzDrawer"],features:[e.qOj,e.TTD],decls:2,vars:0,consts:[["drawerTemplate",""],[1,"ant-drawer",3,"nzNoAnimation"],["class","ant-drawer-mask",3,"ngStyle","click",4,"ngIf"],[1,"ant-drawer-content"],[1,"ant-drawer-wrapper-body"],["class","ant-drawer-header",3,"ant-drawer-header-close-only",4,"ngIf"],[1,"ant-drawer-body",3,"ngStyle"],["cdkPortalOutlet",""],[4,"ngIf","ngIfElse"],["contentElseTemp",""],["class","ant-drawer-footer",4,"ngIf"],[1,"ant-drawer-mask",3,"ngStyle","click"],[1,"ant-drawer-header"],[1,"ant-drawer-header-title"],["aria-label","Close","class","ant-drawer-close","style","--scroll-bar: 0px;",3,"click",4,"ngIf"],["class","ant-drawer-title",4,"ngIf"],["class","ant-drawer-extra",4,"ngIf"],["aria-label","Close",1,"ant-drawer-close",2,"--scroll-bar","0px",3,"click"],[4,"nzStringTemplateOutlet"],["nz-icon","",3,"nzType"],[1,"ant-drawer-title"],[3,"innerHTML"],[1,"ant-drawer-extra"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngTemplateOutlet"],[1,"ant-drawer-footer"]],template:function(t,i){1&t&&e.YNc(0,ue,12,40,"ng-template",null,0,e.W1O)},directives:[D.P,v.O5,v.PC,w.f,Z.Ls,x.Pl,v.tP],encapsulation:2,changeDetection:0}),(0,u.gn)([(0,g.yF)()],o.prototype,"nzClosable",void 0),(0,u.gn)([(0,c.oS)(),(0,g.yF)()],o.prototype,"nzMaskClosable",void 0),(0,u.gn)([(0,c.oS)(),(0,g.yF)()],o.prototype,"nzMask",void 0),(0,u.gn)([(0,c.oS)(),(0,g.yF)()],o.prototype,"nzCloseOnNavigation",void 0),(0,u.gn)([(0,g.yF)()],o.prototype,"nzNoAnimation",void 0),(0,u.gn)([(0,g.yF)()],o.prototype,"nzKeyboard",void 0),(0,u.gn)([(0,c.oS)()],o.prototype,"nzDirection",void 0),o})(),ge=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({}),o})(),fe=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[f.vT,v.ez,h.U8,x.eL,Z.PV,w.T,D.g,ge]]}),o})();const Ce=["participantVideo"],ve=["videoFallBack"];function ze(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"app-call-controls",13),e.NdJ("unReadMessageChange",function(s){return e.CHM(t),e.oxw().unReadMessage=s})("screenSharingChange",function(s){return e.CHM(t),e.oxw().inputs.screenShare=s})("onOpenChat",function(){return e.CHM(t),e.oxw().openChat()})("screenSharingChange",function(s){return e.CHM(t),e.oxw().onScreenSharingChange(s)})("onLeave",function(){return e.CHM(t),e.oxw().leaveSession()})("onMicrophoneChange",function(s){return e.CHM(t),e.oxw().onMicrophoneChange(s)})("onCameraChange",function(s){return e.CHM(t),e.oxw().toogleCamera(s)}),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("unReadMessage",t.unReadMessage)("screenSharing",t.inputs.screenShare)}}function ye(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div"),e._UZ(1,"app-header"),e.TgZ(2,"h4",14),e._uU(3),e.ALo(4,"date"),e.qZA(),e.TgZ(5,"div",15),e._UZ(6,"ng-lottie",16),e.qZA(),e.TgZ(7,"button",17),e.NdJ("click",function(){return e.CHM(t),e.oxw().initConnection()}),e._uU(8,"Connect to classroom"),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(3),e.hij("Lesson ",e.xi3(4,2,null==t.lesson?null:t.lesson.scheduled_at,"MMM d, y, h:mm a"),""),e.xp6(3),e.Q6J("options",t.options)}}function xe(o,a){if(1&o&&e._UZ(0,"nb-chat-message",21),2&o){const t=a.$implicit;e.Q6J("files",t.files)("type",t.type)("message",t.message)("reply",t.reply)("sender",t.user.firstname)("date",t.date)("avatar",t.user.image)}}function Te(o,a){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"nb-chat",18),e.YNc(2,xe,1,7,"nb-chat-message",19),e.TgZ(3,"nb-chat-form",20),e.NdJ("send",function(s){return e.CHM(t),e.oxw().sendMessage(s)}),e.qZA()(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("ngForOf",t.messages),e.xp6(1),e.Q6J("dropFiles",!0)}}const Se=[{path:":id",component:(()=>{class o{constructor(t,i,s,m){this.route=t,this.userService=i,this.callService=s,this.lessonService=m,this.participants=0,this.options={path:"/assets/animations/education.json"},this.audioEncode=!1,this.audioDecode=!1,this.connected=!1,this.inputs={camera:!0,mic:!0,screenShare:!1,chat:!1},this.messages=[],this.name=this.userService.currentUserValue.firstname+" "+this.userService.currentUserValue.lastname,this.unReadMessage=0,this.started=!1,this.lesson=null}ngOnInit(){return(0,u.mG)(this,void 0,void 0,function*(){this.lesson_id=this.route.snapshot.params.id,this.callService.currentRoomId=this.lesson_id,this.lesson=yield this.lessonService.find(this.lesson_id).toPromise(),this.getConnectedUser()})}initConnection(){return(0,u.mG)(this,void 0,void 0,function*(){this.connected||(this.connected=!0,yield this.callService.joinRoom({room_id:this.lesson_id,user_id:this.userService.currentUserValue.id,sessionDescription:yield this.callService.createOffer(this.inputs.camera,this.inputs.mic)}),this.startVideoFallback(),this.callService.peerConnection.ontrack=t=>{this.started=!0,this.participantVideo.nativeElement.srcObject=t.streams[0]},this.callService.onNewParticipant.subscribe(t=>{this.started=!0}),this.callService.onNewMessage.subscribe(t=>{const i=t.type;console.log(t),t.type="text"!=t.type?"file":"text","file"==t.type&&(t.files=[{url:t.content,type:i,icon:"file-text-outline"}]),t.reply=this.userService.currentUserValue.id==t.user_id,t.user=t.reply?this.userService.currentUserValue:this.connectedUser,this.messages.push(t),this.inputs.chat||this.unReadMessage++}),this.callService.onRemoteCameraChange.subscribe(t=>{this.connectedUser.camera=t.active}))})}toogleCamera(t){this.inputs.camera=t,t?this.callService.startVideo():this.callService.stopVideo()}onMicrophoneChange(t){this.inputs.mic=t,t?this.callService.stopAudio():this.callService.startAudio()}onScreenSharingChange(t){this.inputs.screenShare=t,t?this.callService.startScreenShare():(this.callService.stopScreenShare(),this.inputs.camera&&this.toogleCamera(!0))}openChat(){this.unReadMessage=0,this.inputs.chat=!0}sendMessage(t){if(t.files.length){let i=t.files?t.files.map(s=>({data:s,type:s.type,name:s.name})):[];t.files=i}else t.type="text";t.date=(new Date).getTime(),t.room_id=this.lesson_id,t.user_id=this.userService.currentUserValue.id,this.callService.sendMessage(t)}getConnectedUser(){this.connectedUser=this.userService.currentUserValue.id==this.lesson.teacher_id?this.lesson.students[0]||null:this.lesson.teacher,this.connectedUser.camera=!0,console.log(this.connectedUser)}startVideoFallback(){this.callService.stream&&(this.videoFallBack.nativeElement.srcObject=this.callService.stream)}leaveSession(){this.callService.sendDisconnect(),this.callService.clearSubscription()}getInitial(){var t,i,s,m;return(null===(i=null===(t=this.connectedUser)||void 0===t?void 0:t.firstname)||void 0===i?void 0:i.charAt(0))+(null===(m=null===(s=this.connectedUser)||void 0===s?void 0:s.lastname)||void 0===m?void 0:m.charAt(0))}ngOnDestroy(){this.callService.sendDisconnect(),this.callService.clearSubscription()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(n.gz),e.Y36(z.e),e.Y36(P),e.Y36(U.J))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-classroom"]],viewQuery:function(t,i){if(1&t&&(e.Gf(Ce,5),e.Gf(ve,5)),2&t){let s;e.iGM(s=e.CRH())&&(i.participantVideo=s.first),e.iGM(s=e.CRH())&&(i.videoFallBack=s.first)}},decls:18,vars:19,consts:[["nbSpinnerStatus","primary","nbSpinnerMessage","Waiting for remote to connect",3,"nbSpinner"],["autoplay","","playsinline","","id","participants-video",1,"w-100","h-100"],["participantVideo",""],[1,"cover"],[1,"center"],[1,"bg-primary",3,"nzSize","nzText"],[1,"text-center","mt-3","text-grey"],["autoplay","","playsinline","","id","video",1,"video-fallback","max-index",3,"muted"],["videoFallBack",""],[3,"unReadMessage","screenSharing","unReadMessageChange","screenSharingChange","onOpenChat","onLeave","onMicrophoneChange","onCameraChange",4,"ngIf"],[4,"ngIf"],["nzPlacement","left","nzSize","large",3,"nzClosable","nzVisible","nzTitle","nzOnClose"],[4,"nzDrawerContent"],[3,"unReadMessage","screenSharing","unReadMessageChange","screenSharingChange","onOpenChat","onLeave","onMicrophoneChange","onCameraChange"],[1,"text-grey","text-center","mt-4"],[1,"d-block","mx-auto",2,"width","40%"],[3,"options"],["nbButton","","hero","","size","large","status","primary",1,"d-block","mx-auto",3,"click"],["title","Conversation"],["dateFormat","shortTime",3,"files","type","message","reply","sender","date","avatar",4,"ngFor","ngForOf"],[3,"dropFiles","send"],["dateFormat","shortTime",3,"files","type","message","reply","sender","date","avatar"]],template:function(t,i){1&t&&(e.TgZ(0,"nb-layout")(1,"nb-layout-column")(2,"div")(3,"div",0),e._UZ(4,"video",1,2),e.TgZ(6,"div")(7,"div",3)(8,"div",4),e._UZ(9,"nz-avatar",5),e.TgZ(10,"p",6),e._uU(11),e.qZA()()()()(),e._UZ(12,"video",7,8),e.YNc(14,ze,1,2,"app-call-controls",9),e.qZA(),e.YNc(15,ye,9,5,"div",10),e.TgZ(16,"nz-drawer",11),e.NdJ("nzOnClose",function(){return i.inputs.chat=!1}),e.YNc(17,Te,4,2,"ng-container",12),e.qZA()()()),2&t&&(e.xp6(2),e.ekj("d-none",!i.connected),e.xp6(1),e.Q6J("nbSpinner",!i.started&&i.connected),e.xp6(1),e.ekj("d-none",!(null!=i.connectedUser&&i.connectedUser.camera)),e.xp6(2),e.ekj("d-none",null==i.connectedUser?null:i.connectedUser.camera),e.xp6(3),e.Q6J("nzSize",150)("nzText",i.getInitial()),e.xp6(2),e.AsE("",null==i.connectedUser?null:i.connectedUser.firstname," ",null==i.connectedUser?null:i.connectedUser.lastname,""),e.xp6(1),e.ekj("invisible",!i.inputs.camera),e.Q6J("muted",!0),e.xp6(2),e.Q6J("ngIf",i.started),e.xp6(1),e.Q6J("ngIf",!i.connected),e.xp6(1),e.Q6J("nzClosable",!0)("nzVisible",i.inputs.chat)("nzTitle",null))},directives:[_.Aqw,_.dP_,_.Q7R,I.Dz,v.O5,d,y.G,b.e$,_.DPz,V,Y,_.vTO,v.sg,_.ksC,_.iMi],pipes:[v.uU],styles:[".call-controls[_ngcontent-%COMP%]{position:fixed;bottom:50px;left:50%;transform:translate(-50%)}.video-fallback[_ngcontent-%COMP%]{position:fixed;bottom:50px;right:50px;width:400px;height:220px;border-radius:25px}.cover[_ngcontent-%COMP%]{z-index:100;width:100%;height:100%;display:flex;align-items:center;justify-content:center}[_nghost-%COMP%]  .ant-avatar-string{font-size:50px}[_nghost-%COMP%]  .bg-primary{background-color:var(--text-primary-color)!important}[_nghost-%COMP%]  .ant-avatar-string{position:inherit;left:0px}[_nghost-%COMP%]  .center{position:absolute;top:50%;transform:translateY(-50%)}[_nghost-%COMP%]  .text-grey{color:#8f9bb3}[_nghost-%COMP%]  .max-index{z-index:10000}"]}),o})(),canActivate:[S.P]}];let Ne=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[n.Bz.forChild(Se)],n.Bz]}),o})(),Be=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[v.ez,w.T],f.vT]}),o})();var Qe=r(3677),Je=r(7175);let Ge=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[_.kkI],imports:[[v.ez,Ne,I.Rt,Be,Je.m,Z.PV,Qe.b1,_.BW0,_.MAY,_.T2N,fe,_.e6k,_.uuI,_.j5J,_.HKp,b.CT,_.KdK]]}),o})()},9470:(k,M,r)=>{r.d(M,{G:()=>p});var v=r(655),n=r(5e3),S=r(2466),u=r(263),e=r(3175),z=r(325),O=r(4401),l=r(8669),N=r(9808),P=r(2683),U=r(3087);function _(c,g){1&c&&(n.TgZ(0,"button",18),n._UZ(1,"i",19),n._uU(2),n.ALo(3,"translate"),n.qZA()),2&c&&(n.xp6(2),n.hij(" ",n.lcZ(3,1,"header.login"),""))}function I(c,g){1&c&&(n.TgZ(0,"button",20),n._UZ(1,"i",19),n._uU(2),n.ALo(3,"translate"),n.qZA()),2&c&&(n.xp6(2),n.hij(" ",n.lcZ(3,1,"header.register"),""))}function d(c,g){if(1&c){const C=n.EpF();n.TgZ(0,"button",21),n.NdJ("click",function(){return n.CHM(C),n.oxw().goToDashboard()}),n._UZ(1,"i",22),n._uU(2),n.ALo(3,"translate"),n.qZA()}2&c&&(n.xp6(2),n.hij(" ",n.lcZ(3,1,"header.dashboard"),""))}function y(c,g){if(1&c){const C=n.EpF();n.TgZ(0,"button",21),n.NdJ("click",function(){return n.CHM(C),n.oxw().logout()}),n._UZ(1,"i",22),n._uU(2),n.ALo(3,"translate"),n.qZA()}2&c&&(n.xp6(2),n.hij(" ",n.lcZ(3,1,"header.logout"),""))}function b(c,g){1&c&&(n.TgZ(0,"button",18),n._UZ(1,"i",23),n._uU(2),n.ALo(3,"translate"),n.qZA()),2&c&&(n.xp6(2),n.hij(" ",n.lcZ(3,1,"header.login"),""))}function E(c,g){1&c&&(n.TgZ(0,"button",20),n._UZ(1,"i",23),n._uU(2),n.ALo(3,"translate"),n.qZA()),2&c&&(n.xp6(2),n.hij(" ",n.lcZ(3,1,"header.register")," !"))}function h(c,g){if(1&c){const C=n.EpF();n.TgZ(0,"button",21),n.NdJ("click",function(){return n.CHM(C),n.oxw().goToDashboard()}),n._UZ(1,"i",22),n._uU(2),n.ALo(3,"translate"),n.qZA()}2&c&&(n.xp6(2),n.hij(" ",n.lcZ(3,1,"header.dashboard"),""))}function x(c,g){if(1&c){const C=n.EpF();n.TgZ(0,"button",21),n.NdJ("click",function(){return n.CHM(C),n.oxw().logout()}),n._UZ(1,"i",22),n._uU(2),n.ALo(3,"translate"),n.qZA()}2&c&&(n.xp6(2),n.hij(" ",n.lcZ(3,1,"header.logout"),""))}let p=(()=>{class c{constructor(C,f,D,w,Z){var L;this.translationService=C,this.authService=f,this.cdr=D,this.chatService=w,this.router=Z,this.language=null!==(L=localStorage.getItem("language"))&&void 0!==L?L:"en",this.unreadMessageCount=0}ngOnInit(){this.isConnected=!!this.authService.getToken(),this.cdr.markForCheck()}languageChange(C="en"){localStorage.setItem("language",C),this.translationService.use(C)}goToDashboard(){return(0,v.mG)(this,void 0,void 0,function*(){yield this.authService.populate();const C=this.authService.currentUserValue;"student"==C.role.slug?this.router.navigate(["student/dashboard"]):"teacher"==C.role.slug?this.router.navigate(["teacher/dashboard"]):"admin"==C.role.slug&&this.router.navigate(["admin"])})}goToMessages(){this.router.navigate(["/messages"])}logout(){this.authService.purgeAuth(),this.router.navigate(["/"])}}return c.\u0275fac=function(C){return new(C||c)(n.Y36(S.sK),n.Y36(u.e),n.Y36(n.sBO),n.Y36(e.a),n.Y36(z.F0))},c.\u0275cmp=n.Xpm({type:c,selectors:[["app-header"]],decls:36,vars:19,consts:[[1,"navbar","navbar-expand-sm","navbar-light","bg-white","px-md-4","px-2","py-0"],["routerLink","/",1,"navbar-brand"],["src","../../../assets/logo.png","width","60",1,"logo"],["id","navbarNav",1,"collapse","navbar-collapse","d-none","d-md-block"],[1,"navbar-nav","mr-auto"],[1,"nav-item"],["routerLink","",1,"nav-link"],[1,"nav-link"],[1,"d-inline"],[1,"mx-3","pointer",3,"nzCount","click"],["icon","inbox-outline","pack","eva",1,"d-inline-block"],["size","small",1,"language-selector",3,"selected","selectedChange"],["selected","","value","en"],["value","fr"],["nbButton","","hero","","size","small","routerLink","/login","class","mx-2",4,"ngIf"],["nbButton","","hero","","status","primary","size","small","routerLink","/register","class"," ml-2 mr-4",4,"ngIf"],["nbButton","","hero","","status","primary","size","small","class"," ml-2 mr-4",3,"click",4,"ngIf"],[1,"float-right","d-inline","d-md-none","mobile-menu"],["nbButton","","hero","","size","small","routerLink","/login",1,"mx-2"],["nz-icon","","nzType","user","nzTheme","outline",1,"mr-2"],["nbButton","","hero","","status","primary","size","small","routerLink","/register",1,"ml-2","mr-4"],["nbButton","","hero","","status","primary","size","small",1,"ml-2","mr-4",3,"click"],["nz-icon","","nzType","user","nzTheme","outline"],["nz-icon","","nzType","user","nzTheme","outline",1,"mx-2"]],template:function(C,f){1&C&&(n.TgZ(0,"nav",0)(1,"a",1),n._UZ(2,"img",2),n.qZA(),n.TgZ(3,"div",3)(4,"ul",4)(5,"li",5)(6,"a",6),n._uU(7),n.ALo(8,"translate"),n.qZA()(),n.TgZ(9,"li",5)(10,"a",7),n._uU(11),n.ALo(12,"translate"),n.qZA()(),n.TgZ(13,"li",5)(14,"a",7),n._uU(15),n.ALo(16,"translate"),n.qZA()()(),n.TgZ(17,"div",8)(18,"div",8)(19,"nz-badge",9),n.NdJ("click",function(){return f.goToMessages()}),n._UZ(20,"nb-icon",10),n.qZA()(),n.TgZ(21,"nb-select",11),n.NdJ("selectedChange",function(w){return f.languageChange(w)})("selectedChange",function(w){return f.language=w}),n.TgZ(22,"nb-option",12),n._uU(23,"\u{1f1ec}\u{1f1e7}"),n.qZA(),n.TgZ(24,"nb-option",13),n._uU(25,"\u{1f1eb}\u{1f1f7}"),n.qZA()(),n.YNc(26,_,4,3,"button",14),n.YNc(27,I,4,3,"button",15),n.YNc(28,d,4,3,"button",16),n.YNc(29,y,4,3,"button",16),n.qZA()(),n.TgZ(30,"div",17)(31,"div",8),n.YNc(32,b,4,3,"button",14),n.YNc(33,E,4,3,"button",15),n.YNc(34,h,4,3,"button",16),n.YNc(35,x,4,3,"button",16),n.qZA()()()),2&C&&(n.xp6(7),n.Oqu(n.lcZ(8,13,"header.home")),n.xp6(4),n.Oqu(n.lcZ(12,15,"header.about")),n.xp6(4),n.Oqu(n.lcZ(16,17,"header.contact")),n.xp6(4),n.Q6J("nzCount",f.unreadMessageCount),n.xp6(2),n.Q6J("selected",f.language),n.xp6(5),n.Q6J("ngIf",!f.isConnected),n.xp6(1),n.Q6J("ngIf",!f.isConnected),n.xp6(1),n.Q6J("ngIf",f.isConnected&&"/student/dashboard"!=f.router.url&&"/teacher/dashboard"!=f.router.url),n.xp6(1),n.Q6J("ngIf",f.isConnected&&("/student/dashboard"==f.router.url||"/teacher/dashboard"==f.router.url)),n.xp6(3),n.Q6J("ngIf",!f.isConnected),n.xp6(1),n.Q6J("ngIf",!f.isConnected),n.xp6(1),n.Q6J("ngIf",f.isConnected&&"/student/dashboard"!=f.router.url&&"/teacher/dashboard"!=f.router.url),n.xp6(1),n.Q6J("ngIf",f.isConnected&&("/student/dashboard"==f.router.url||"/teacher/dashboard"==f.router.url)))},directives:[z.yS,O.x7,l.fMN,l.rs,l.q51,N.O5,l.DPz,z.rH,P.w,U.Ls],pipes:[S.X$],styles:["a[_ngcontent-%COMP%]{text-decoration:none!important}.navbar-light[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{color:#000}nb-icon[_ngcontent-%COMP%]{vertical-align:middle}[_nghost-%COMP%]  .language-selector{z-index:-1}[_nghost-%COMP%]  .ant-scroll-number-only-unit{font-weight:400;font-size:12px;line-height:20px;color:#fff!important}[_nghost-%COMP%]  .ant-badge-count{z-index:auto;min-width:20px;height:20px;padding:0 6px;white-space:nowrap;text-align:center;background:#45aca0;border-radius:10px;box-shadow:0 0 0 1px #fff}[_nghost-%COMP%]  i{transform:translateY(0)}"]}),c})()},6699:(k,M,r)=>{r.d(M,{Dz:()=>y,Rt:()=>E});var v=r(655),n=r(5e3),S=r(9439),u=r(1721),e=r(925),z=r(9808),O=r(3087),l=r(226);const N=["textEl"];function P(h,x){if(1&h&&n._UZ(0,"i",3),2&h){const p=n.oxw();n.Q6J("nzType",p.nzIcon)}}function U(h,x){if(1&h){const p=n.EpF();n.TgZ(0,"img",4),n.NdJ("error",function(g){return n.CHM(p),n.oxw().imgError(g)}),n.qZA()}if(2&h){const p=n.oxw();n.Q6J("src",p.nzSrc,n.LSH),n.uIk("srcset",p.nzSrcSet,n.LSH)("alt",p.nzAlt)}}function _(h,x){if(1&h&&(n.TgZ(0,"span",5,6),n._uU(2),n.qZA()),2&h){const p=n.oxw();n.Q6J("ngStyle",p.textStyles),n.xp6(2),n.Oqu(p.nzText)}}let y=(()=>{class h{constructor(p,c,g,C){this.nzConfigService=p,this.elementRef=c,this.cdr=g,this.platform=C,this._nzModuleName="avatar",this.nzShape="circle",this.nzSize="default",this.nzGap=4,this.nzError=new n.vpe,this.hasText=!1,this.hasSrc=!0,this.hasIcon=!1,this.textStyles={},this.classMap={},this.customSize=null,this.el=this.elementRef.nativeElement}imgError(p){this.nzError.emit(p),p.defaultPrevented||(this.hasSrc=!1,this.hasIcon=!1,this.hasText=!1,this.nzIcon?this.hasIcon=!0:this.nzText&&(this.hasText=!0),this.cdr.detectChanges(),this.setSizeStyle(),this.notifyCalc())}ngOnChanges(){this.hasText=!this.nzSrc&&!!this.nzText,this.hasIcon=!this.nzSrc&&!!this.nzIcon,this.hasSrc=!!this.nzSrc,this.setSizeStyle(),this.notifyCalc()}calcStringSize(){if(!this.hasText)return;const p=this.textEl.nativeElement.offsetWidth,c=this.el.getBoundingClientRect().width,g=2*this.nzGap<c?2*this.nzGap:8;this.textStyles={transform:`scale(${c-g<p?(c-g)/p:1}) translateX(-50%)`},this.customSize&&Object.assign(this.textStyles,{lineHeight:this.customSize}),this.cdr.detectChanges()}notifyCalc(){this.platform.isBrowser&&setTimeout(()=>{this.calcStringSize()})}setSizeStyle(){this.customSize="number"==typeof this.nzSize?`${this.nzSize}px`:null,this.cdr.markForCheck()}}return h.\u0275fac=function(p){return new(p||h)(n.Y36(S.jY),n.Y36(n.SBq),n.Y36(n.sBO),n.Y36(e.t4))},h.\u0275cmp=n.Xpm({type:h,selectors:[["nz-avatar"]],viewQuery:function(p,c){if(1&p&&n.Gf(N,5),2&p){let g;n.iGM(g=n.CRH())&&(c.textEl=g.first)}},hostAttrs:[1,"ant-avatar"],hostVars:20,hostBindings:function(p,c){2&p&&(n.Udp("width",c.customSize)("height",c.customSize)("line-height",c.customSize)("font-size",c.hasIcon&&c.customSize?c.nzSize/2:null,"px"),n.ekj("ant-avatar-lg","large"===c.nzSize)("ant-avatar-sm","small"===c.nzSize)("ant-avatar-square","square"===c.nzShape)("ant-avatar-circle","circle"===c.nzShape)("ant-avatar-icon",c.nzIcon)("ant-avatar-image",c.hasSrc))},inputs:{nzShape:"nzShape",nzSize:"nzSize",nzGap:"nzGap",nzText:"nzText",nzSrc:"nzSrc",nzSrcSet:"nzSrcSet",nzAlt:"nzAlt",nzIcon:"nzIcon"},outputs:{nzError:"nzError"},exportAs:["nzAvatar"],features:[n.TTD],decls:3,vars:3,consts:[["nz-icon","",3,"nzType",4,"ngIf"],[3,"src","error",4,"ngIf"],["class","ant-avatar-string",3,"ngStyle",4,"ngIf"],["nz-icon","",3,"nzType"],[3,"src","error"],[1,"ant-avatar-string",3,"ngStyle"],["textEl",""]],template:function(p,c){1&p&&(n.YNc(0,P,1,1,"i",0),n.YNc(1,U,1,3,"img",1),n.YNc(2,_,3,2,"span",2)),2&p&&(n.Q6J("ngIf",c.nzIcon&&c.hasIcon),n.xp6(1),n.Q6J("ngIf",c.nzSrc&&c.hasSrc),n.xp6(1),n.Q6J("ngIf",c.nzText&&c.hasText))},directives:[z.O5,O.Ls,z.PC],encapsulation:2,changeDetection:0}),(0,v.gn)([(0,S.oS)()],h.prototype,"nzShape",void 0),(0,v.gn)([(0,S.oS)()],h.prototype,"nzSize",void 0),(0,v.gn)([(0,S.oS)(),(0,u.Rn)()],h.prototype,"nzGap",void 0),h})(),E=(()=>{class h{}return h.\u0275fac=function(p){return new(p||h)},h.\u0275mod=n.oAB({type:h}),h.\u0275inj=n.cJS({imports:[[l.vT,z.ez,O.PV,e.ud]]}),h})()}}]);